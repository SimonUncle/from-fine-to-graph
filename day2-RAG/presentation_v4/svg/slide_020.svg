<svg viewBox="0 0 1920 1080" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <filter id="shadow020">
      <feDropShadow dx="0" dy="6" stdDeviation="8" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="#f8f9ff"/>

  <!-- Title -->
  <text x="960" y="100" font-family="Arial, sans-serif" font-size="60" fill="#333" text-anchor="middle" font-weight="bold">CRAG (Corrective RAG)</text>
  <text x="960" y="160" font-family="Arial, sans-serif" font-size="30" fill="#666" text-anchor="middle">검색 결과를 자동으로 검증하고 수정</text>

  <!-- Flow Diagram -->
  <!-- Step 1: Query -->
  <g transform="translate(160, 240)">
    <rect width="320" height="140" rx="20" fill="white" stroke="#667eea" stroke-width="4" filter="url(#shadow020)"/>
    <text x="160" y="50" font-family="Arial, sans-serif" font-size="28" fill="#333" text-anchor="middle" font-weight="bold">1️⃣ 사용자 질문</text>
    <rect x="40" y="70" width="240" height="50" rx="10" fill="#e8eaf6"/>
    <text x="160" y="103" font-family="monospace" font-size="20" fill="#667eea" text-anchor="middle">"김치찌개 재료는?"</text>
  </g>

  <!-- Arrow 1 -->
  <path d="M 480 310 L 560 310" stroke="#667eea" stroke-width="4" fill="none"/>
  <polygon points="560,310 545,300 545,320" fill="#667eea"/>

  <!-- Step 2: Retrieval -->
  <g transform="translate(560, 240)">
    <rect width="320" height="140" rx="20" fill="white" stroke="#667eea" stroke-width="4" filter="url(#shadow020)"/>
    <text x="160" y="50" font-family="Arial, sans-serif" font-size="28" fill="#333" text-anchor="middle" font-weight="bold">2️⃣ 문서 검색</text>
    <text x="160" y="95" font-family="Arial, sans-serif" font-size="20" fill="#666" text-anchor="middle">벡터 DB에서</text>
    <text x="160" y="125" font-family="Arial, sans-serif" font-size="20" fill="#666" text-anchor="middle">Top-K 문서 검색</text>
  </g>

  <!-- Arrow 2 -->
  <path d="M 880 310 L 960 310" stroke="#667eea" stroke-width="4" fill="none"/>
  <polygon points="960,310 945,300 945,320" fill="#667eea"/>

  <!-- Step 3: LLM Evaluator (Key Part) -->
  <g transform="translate(960, 240)">
    <rect width="800" height="140" rx="20" fill="white" stroke="#ff9800" stroke-width="4" filter="url(#shadow020)"/>
    <text x="400" y="50" font-family="Arial, sans-serif" font-size="32" fill="#ff9800" text-anchor="middle" font-weight="bold">3️⃣ LLM Evaluator 🔍</text>
    <text x="400" y="95" font-family="Arial, sans-serif" font-size="22" fill="#333" text-anchor="middle" font-weight="bold">검색된 문서를 평가: Correct? Incorrect? Ambiguous?</text>
  </g>

  <!-- Three Paths -->
  <!-- Path A: Correct -->
  <g transform="translate(160, 440)">
    <rect width="440" height="520" rx="20" fill="white" stroke="#27AE60" stroke-width="4" filter="url(#shadow020)"/>
    <text x="220" y="50" font-family="Arial, sans-serif" font-size="32" fill="#27AE60" text-anchor="middle" font-weight="bold">✅ Correct</text>
    
    <rect x="40" y="80" width="360" height="120" rx="15" fill="#e8f5e9"/>
    <text x="220" y="115" font-family="Arial, sans-serif" font-size="22" fill="#333" text-anchor="middle" font-weight="bold">판단 기준:</text>
    <text x="60" y="150" font-family="Arial, sans-serif" font-size="20" fill="#666">문서가 질문과</text>
    <text x="60" y="180" font-family="Arial, sans-serif" font-size="20" fill="#666">명확하게 관련됨</text>

    <text x="220" y="240" font-family="Arial, sans-serif" font-size="36" fill="#27AE60" text-anchor="middle">↓</text>

    <rect x="40" y="270" width="360" height="220" rx="15" fill="#c8e6c9"/>
    <text x="220" y="310" font-family="Arial, sans-serif" font-size="24" fill="#333" text-anchor="middle" font-weight="bold">액션:</text>
    <text x="60" y="350" font-family="Arial, sans-serif" font-size="20" fill="#666">검색된 문서를</text>
    <text x="60" y="385" font-family="Arial, sans-serif" font-size="20" fill="#666">그대로 사용하여</text>
    <text x="60" y="420" font-family="Arial, sans-serif" font-size="20" fill="#666">답변 생성</text>
    <text x="220" y="460" font-family="Arial, sans-serif" font-size="22" fill="#27AE60" font-weight="bold">→ 정상 RAG</text>
  </g>

  <!-- Path B: Incorrect -->
  <g transform="translate(660, 440)">
    <rect width="440" height="520" rx="20" fill="white" stroke="#ff6b6b" stroke-width="4" filter="url(#shadow020)"/>
    <text x="220" y="50" font-family="Arial, sans-serif" font-size="32" fill="#ff6b6b" text-anchor="middle" font-weight="bold">❌ Incorrect</text>
    
    <rect x="40" y="80" width="360" height="120" rx="15" fill="#ffebee"/>
    <text x="220" y="115" font-family="Arial, sans-serif" font-size="22" fill="#333" text-anchor="middle" font-weight="bold">판단 기준:</text>
    <text x="60" y="150" font-family="Arial, sans-serif" font-size="20" fill="#666">문서가 질문과</text>
    <text x="60" y="180" font-family="Arial, sans-serif" font-size="20" fill="#666">전혀 관련 없음</text>

    <text x="220" y="240" font-family="Arial, sans-serif" font-size="36" fill="#ff6b6b" text-anchor="middle">↓</text>

    <rect x="40" y="270" width="360" height="220" rx="15" fill="#ffcdd2"/>
    <text x="220" y="310" font-family="Arial, sans-serif" font-size="24" fill="#333" text-anchor="middle" font-weight="bold">액션:</text>
    <text x="60" y="350" font-family="Arial, sans-serif" font-size="20" fill="#666">내부 문서 버리고</text>
    <text x="60" y="385" font-family="Arial, sans-serif" font-size="20" fill="#666">웹 검색으로</text>
    <text x="60" y="420" font-family="Arial, sans-serif" font-size="20" fill="#666">외부 정보 확보</text>
    <text x="220" y="460" font-family="Arial, sans-serif" font-size="22" fill="#ff6b6b" font-weight="bold">→ 웹 검색</text>
  </g>

  <!-- Path C: Ambiguous -->
  <g transform="translate(1160, 440)">
    <rect width="600" height="520" rx="20" fill="white" stroke="#ff9800" stroke-width="4" filter="url(#shadow020)"/>
    <text x="300" y="50" font-family="Arial, sans-serif" font-size="32" fill="#ff9800" text-anchor="middle" font-weight="bold">⚠️ Ambiguous</text>
    
    <rect x="40" y="80" width="520" height="120" rx="15" fill="#fff3e0"/>
    <text x="300" y="115" font-family="Arial, sans-serif" font-size="22" fill="#333" text-anchor="middle" font-weight="bold">판단 기준:</text>
    <text x="60" y="150" font-family="Arial, sans-serif" font-size="20" fill="#666">문서가 부분적으로 관련있지만</text>
    <text x="60" y="180" font-family="Arial, sans-serif" font-size="20" fill="#666">완전하지 않음</text>

    <text x="300" y="240" font-family="Arial, sans-serif" font-size="36" fill="#ff9800" text-anchor="middle">↓</text>

    <rect x="40" y="270" width="520" height="220" rx="15" fill="#ffe0b2"/>
    <text x="300" y="310" font-family="Arial, sans-serif" font-size="24" fill="#333" text-anchor="middle" font-weight="bold">액션:</text>
    <text x="60" y="350" font-family="Arial, sans-serif" font-size="20" fill="#666">1. Knowledge Strips 추출</text>
    <text x="60" y="385" font-family="Arial, sans-serif" font-size="20" fill="#666">   (문서에서 핵심 정보만 발췌)</text>
    <text x="60" y="420" font-family="Arial, sans-serif" font-size="20" fill="#666">2. 웹 검색으로 추가 정보 보완</text>
    <text x="300" y="460" font-family="Arial, sans-serif" font-size="22" fill="#ff9800" font-weight="bold">→ 하이브리드 접근</text>
  </g>
</svg>
